package main

import (
	"context"
	"fmt"
	"strconv"
	"time"

	"WinUpdBrief/internal/updates"
)

func main() {
	// 这里假设你已有 buildStr，比如 "26200"
	buildStr := "26200"

	build, _ := strconv.Atoi(buildStr)
	history := updates.HistoryURLByBuild(build)

	f := updates.NewFetcher()

	ctx, cancel := context.WithTimeout(context.Background(), 25*time.Second)
	defer cancel()

	latest, err := f.FetchLatestFromHistory(ctx, history)
	if err != nil {
		panic(err)
	}

	fmt.Println("History:", latest.HistoryURL)
	fmt.Println("Latest :", latest.Title)
	fmt.Println("KB     :", latest.KB)
	fmt.Println("URL    :", latest.URL)
}
